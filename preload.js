const { contextBridge, ipcRenderer } = require("electron");

contextBridge.exposeInMainWorld("electronAPI", {
  setKeybind: (action, key, isGlobal) => ipcRenderer.send("set-keybind", { action, key, isGlobal }),
  onLoadKeybinds: (callback) => ipcRenderer.on("load-keybinds", callback),
  onTriggerAction: (callback) => ipcRenderer.on("trigger-action", callback),
  getFissures: () => ipcRenderer.invoke("get-fissures"),
  getSettings: () => ipcRenderer.invoke("get-settings"),
  setFilters: (filters) => ipcRenderer.send("set-filters", filters),
  onMissionCompleteDetected: (callback) => ipcRenderer.on('mission-complete-detected', callback),
  onScannerStatusUpdate: (callback) => ipcRenderer.on('scanner-status-update', callback),
  toggleAutoScan: (enabled) => ipcRenderer.send('toggle-auto-scan', enabled),
  setAutoScanPause: (seconds) => ipcRenderer.send('set-auto-scan-pause', seconds),
  setOSDEnabled: (enabled) => ipcRenderer.send('set-osd-enabled', enabled),
  updateOSD: (data) => ipcRenderer.send('update-osd', data),
  setOSDOpacity: (opacity) => ipcRenderer.send('set-osd-opacity', opacity),
  setOSDScale: (scale) => ipcRenderer.send('set-osd-scale', scale),
  setOSDLocked: (locked) => ipcRenderer.send('set-osd-locked', locked),
  setUISettings: (settings) => ipcRenderer.send('set-ui-settings', settings),
  setRelicName: (name) => ipcRenderer.send('set-relic-name', name),
  setRotationMode: (mode) => ipcRenderer.send('set-rotation-mode', mode),
  set1b1Position: (pos) => ipcRenderer.send('set-1b1-position', pos),
  setHydrationReminderEnabled: (enabled) => ipcRenderer.send('set-hydration-reminder-enabled', enabled),
  selectHydrationSound: () => ipcRenderer.invoke('select-hydration-sound'),
  setHydrationInterval: (minutes) => ipcRenderer.send('set-hydration-interval', minutes),
  setHydrationSound: (path) => ipcRenderer.send('set-hydration-sound', path),
  setHydrationSoundVolume: (volume) => ipcRenderer.send('set-hydration-sound-volume', volume),
  readHydrationSound: () => ipcRenderer.invoke('read-hydration-sound'),
  onHydrationStateChanged: (callback) => ipcRenderer.on('hydration-state-changed', callback),
  onTriggerHydration: (callback) => ipcRenderer.on('trigger-hydration', callback),
  setNextSoundEnabled: (enabled) => ipcRenderer.send('set-next-sound-enabled', enabled),
  setNextSound: (path) => ipcRenderer.send('set-next-sound', path),
  setNextSoundVolume: (volume) => ipcRenderer.send('set-next-sound-volume', volume),
  readNextSound: () => ipcRenderer.invoke('read-next-sound'),
  setFissureSoundEnabled: (enabled) => ipcRenderer.send('set-fissure-sound-enabled', enabled),
  setFissureSound: (path) => ipcRenderer.send('set-fissure-sound', path),
  setFissureSoundVolume: (volume) => ipcRenderer.send('set-fissure-sound-volume', volume),
  readFissureSound: () => ipcRenderer.invoke('read-fissure-sound'),
  openExternal: (url) => ipcRenderer.send('open-external', url),
  setLayout: (layout) => ipcRenderer.send('set-layout', layout),
  checkForUpdate: () => ipcRenderer.send('check-for-update'),
  onUpdateStatus: (callback) => ipcRenderer.on('update-status', callback),
  onUpdateAvailable: (callback) => ipcRenderer.on('update-available', callback),
  onUpdateDownloaded: (callback) => ipcRenderer.on('update-downloaded', callback),
  downloadUpdate: () => ipcRenderer.send('download-update'),
  quitAndInstall: () => ipcRenderer.send('quit-and-install'),
  onResyncScannerState: (callback) => ipcRenderer.on('resync-scanner-state', callback),
  testLogReader: () => ipcRenderer.invoke('test-log-reader'),
  setVoidCascadeMode: (enabled) => ipcRenderer.send('set-void-cascade-mode', enabled),
  setHotkeyEnabled: (enabled) => ipcRenderer.send('set-hotkey-enabled', enabled),
  setAutoRelicEnabled: (enabled) => ipcRenderer.send('set-auto-relic-enabled', enabled),
  onDetectedRelic: (callback) => ipcRenderer.on('detected-relic', callback),
  setCloseToTray: (enabled) => ipcRenderer.send('set-close-to-tray', enabled),
  setAlwaysOnTop: (enabled) => ipcRenderer.send('set-always-on-top', enabled),
  setOSDShowClock: (enabled) => ipcRenderer.send('set-osd-show-clock', enabled),
  setOSDHydrationNotify: (enabled) => ipcRenderer.send('set-osd-hydration-notify', enabled),
  setOSDHideBorder: (enabled) => ipcRenderer.send('set-osd-hide-border', enabled),
  setHydrationTheme: (theme) => ipcRenderer.send('set-hydration-theme', theme),
  setHydrationMessage: (message) => ipcRenderer.send('set-hydration-message', message),
  setFlagTheme: (theme) => ipcRenderer.send('set-flag-theme', theme),
  setFlagEnabled: (enabled) => ipcRenderer.send('set-flag-enabled', enabled),
  setFlagPosition: (position) => ipcRenderer.send('set-flag-position', position)
});

contextBridge.exposeInMainWorld("osdAPI", {
  onUpdateData: (callback) => ipcRenderer.on('update-osd-data', callback),
  onUpdateStyle: (callback) => ipcRenderer.on('update-osd-style', callback),
  drag: (pos) => ipcRenderer.send('osd-drag', pos)
});
